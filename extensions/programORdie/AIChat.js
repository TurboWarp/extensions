// Name: AI  Chat
// ID: aichat_programordie
// Description: Use an AI Chatbot in your projects that can answer questions, follow your instructions, generate stories and much more!
// By: programORdie <https://scratch.mit.edu/users/programORdie/>

(function (Scratch) {
  "use strict";

const blockIcon = "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NzEuMTk0IiBoZWlnaHQ9IjY4MC4yNDg3IiB2aWV3Qm94PSIwIDAgNjcxLjE5NCA2ODAuMjQ4NyI+PHBhdGggZD0iTTYyNi45NDY0LDI3OC40MDM3YTE2OS40NDkyLDE2OS40NDkyLDAsMCwwLTE0LjU2NDItMTM5LjE4N0ExNzEuMzgyOCwxNzEuMzgyOCwwLDAsMCw0MjcuNzg4Myw1Ni45ODQxLDE2OS40NSwxNjkuNDUsMCwwLDAsMjk5Ljk3NDYuMDAzNCwxNzEuMzk4NSwxNzEuMzk4NSwwLDAsMCwxMzYuNDc1MSwxMTguNjcxOSwxNjkuNTA3NywxNjkuNTA3NywwLDAsMCwyMy4xNTc0LDIwMC44Nzc1LDE3MS40MSwxNzEuNDEsMCwwLDAsNDQuMjM4NSw0MDEuODQ1LDE2OS40NTY0LDE2OS40NTY0LDAsMCwwLDU4LjgwMjEsNTQxLjAzMjVhMTcxLjQsMTcxLjQsMCwwLDAsMTg0LjU5NDUsODIuMjMxOEExNjkuNDQ3NCwxNjkuNDQ3NCwwLDAsMCwzNzEuMjEsNjgwLjI0NTQsMTcxLjQsMTcxLjQsMCwwLDAsNTM0Ljc2NDIsNTYxLjUxYTE2OS41MDQsMTY5LjUwNCwwLDAsMCwxMTMuMzE3NS04Mi4yMDYzLDE3MS40MTE2LDE3MS40MTE2LDAsMCwwLTIxLjEzNTMtMjAwLjlaTTM3MS4yNjQ3LDYzNS43NzU4YTEyNy4xMDc3LDEyNy4xMDc3LDAsMCwxLTgxLjYwMjctMjkuNTAyNGMxLjAzMjMtLjU2MjksMi44NDM1LTEuNTU2LDQuMDIzNy0yLjI3ODhMNDI5LjEzLDUyNS43NTc1YTIyLjAyMjYsMjIuMDIyNiwwLDAsMCwxMS4xMzA2LTE5LjI3VjMxNS41MzY4bDU3LjI1LDMzLjA1NjdhMi4wMzMyLDIuMDMzMiwwLDAsMSwxLjExMjIsMS41NjhWNTA4LjI5NzJBMTI3LjY0LDEyNy42NCwwLDAsMSwzNzEuMjY0Nyw2MzUuNzc1OFpNOTcuMzcwNSw1MTguNzk4NWExMjcuMDUzNiwxMjcuMDUzNiwwLDAsMS0xNS4yMDc0LTg1LjQyNTZjMS4wMDU3LjYwMzcsMi43NjI0LDEuNjc2OCw0LjAyMzEsMi40MDEyTDIyMS42Myw1MTQuMDFhMjIuMDQsMjIuMDQsMCwwLDAsMjIuMjQ5MiwwTDQwOS4yNDMsNDE4LjUyODF2NjYuMTEzNGEyLjA1MjksMi4wNTI5LDAsMCwxLS44MTgsMS43NTY4bC0xMzYuOTIsNzkuMDUzNGExMjcuNjE0NSwxMjcuNjE0NSwwLDAsMS0xNzQuMTM0LTQ2LjY1MzJaTTYxLjczOTEsMjIzLjExMTRhMTI3LjAxNDYsMTI3LjAxNDYsMCwwLDEsNjYuMzU0NS01NS44OTQ0YzAsMS4xNjY3LS4wNjcsMy4yMzI5LS4wNjcsNC42NjY1VjMyOC4zNTYxYTIyLjAwMzgsMjIuMDAzOCwwLDAsMCwxMS4xMTczLDE5LjI1NzhsMTY1LjM2MjksOTUuNDY5NS01Ny4yNDgxLDMzLjA1NWEyLjA1NDksMi4wNTQ5LDAsMCwxLTEuOTMxOS4xNzUybC0xMzYuOTMzLTc5LjEyMTVBMTI3LjYxMzksMTI3LjYxMzksMCwwLDEsNjEuNzM5MSwyMjMuMTExNFpNNTMyLjA5NTksMzMyLjU2NjgsMzY2LjczMDgsMjM3LjA4NTRsNTcuMjUtMzMuMDQzMWEyLjA0NTUsMi4wNDU1LDAsMCwxLDEuOTMtLjE3MzVsMTM2LjkzNCw3OS4wNTM1YTEyNy41MDQ3LDEyNy41MDQ3LDAsMCwxLTE5LjcsMjMwLjA1NVYzNTEuODI0N2EyMS45OTYxLDIxLjk5NjEsMCwwLDAtMTEuMDQ4OS0xOS4yNTc5Wm01Ni45NzkzLTg1Ljc1ODljLTEuMDA1MS0uNjE3NC0yLjc2MTgtMS42NzY5LTQuMDIxOS0yLjRMNDQ5LjYwNzIsMTY2LjE3MTJhMjIuMDcsMjIuMDcsMCwwLDAtMjIuMjQ3NSwwTDI2MS45OTYzLDI2MS42NTQzVjE5NS41NDA5YTIuMDUyOSwyLjA1MjksMCwwLDEsLjgxOC0xLjc1NjdsMTM2LjkyMDUtNzguOTg4YTEyNy40OTIzLDEyNy40OTIzLDAsMCwxLDE4OS4zNCwxMzIuMDExN1pNMjMwLjg3MTYsMzY0LjY0NTYsMTczLjYwODIsMzMxLjU4OWEyLjAzMjEsMi4wMzIxLDAsMCwxLTEuMTEyMi0xLjU3VjE3MS44ODM1QTEyNy40OTI2LDEyNy40OTI2LDAsMCwxLDM4MS41NjM2LDczLjk4ODRjLTEuMDMyMi41NjMzLTIuODMsMS41NTU4LTQuMDIzNiwyLjI4TDI0Mi4wOTU3LDE1NC41MDQ0YTIyLjAwMjUsMjIuMDAyNSwwLDAsMC0xMS4xMzA2LDE5LjI1NjZabTMxLjA5NzUtNjcuMDUyMUwzMzUuNjIsMjU1LjA1NTlsNzMuNjQ4OCw0Mi41MXY4NS4wNDgxTDMzNS42Miw0MjUuMTI2NmwtNzMuNjUwNi00Mi41MTIyWiIvPjwvc3ZnPg==";
const menuIcon = "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2aWV3Qm94PSIwIDAgMjQwNiAyNDA2Ij4KCTxwYXRoIGQ9Ik0xIDU3OC40QzEgMjU5LjUgMjU5LjUgMSA1NzguNCAxaDEyNDkuMWMzMTkgMCA1NzcuNSAyNTguNSA1NzcuNSA1NzcuNFYyNDA2SDU3OC40QzI1OS41IDI0MDYgMSAyMTQ3LjUgMSAxODI4LjZWNTc4LjR6IiBmaWxsPSIjNzRhYTljIi8+Cgk8cGF0aCBpZD0iYSIgZD0iTTExMDcuMyAyOTkuMWMtMTk3Ljk5OSAwLTM3My45IDEyNy4zLTQzNS4yIDMxNS4zTDY1MCA3NDMuNXY0MjcuOWMwIDIxLjQgMTEgNDAuNCAyOS40IDUxLjRsMzQ0LjUgMTk4LjUxNVY4MzMuM2guMXYtMjcuOUwxMzcyLjcgNjA0YzMzLjcxNS0xOS41MiA3MC40NC0zMi44NTcgMTA4LjQ3LTM5LjgyOEwxNDQ3LjYgNDUwLjNDMTM2MSAzNTMuNSAxMjM3LjEgMjk4LjUgMTEwNy4zIDI5OS4xem0wIDExNy41LS42LjZjNzkuNjk5IDAgMTU2LjMgMjcuNSAyMTcuNiA3OC40LTIuNSAxLjItNy40IDQuMy0xMSA2LjFMOTUyLjggNzA5LjNjLTE4LjQgMTAuNC0yOS40IDMwLTI5LjQgNTEuNFYxMjQ4bC0xNTUuMS04OS40Vjc1NS44Yy0uMS0xODcuMDk5IDE1MS42MDEtMzM4LjkgMzM5LTMzOS4yeiIgZmlsbD0iI2ZmZiIvPgoJPHVzZSB4bGluazpocmVmPSIjYSIgdHJhbnNmb3JtPSJyb3RhdGUoNjAgMTIwMyAxMjAzKSIvPgogIAk8dXNlIHhsaW5rOmhyZWY9IiNhIiB0cmFuc2Zvcm09InJvdGF0ZSgxMjAgMTIwMyAxMjAzKSIvPgoJPHVzZSB4bGluazpocmVmPSIjYSIgdHJhbnNmb3JtPSJyb3RhdGUoMTgwIDEyMDMgMTIwMykiLz4KCTx1c2UgeGxpbms6aHJlZj0iI2EiIHRyYW5zZm9ybT0icm90YXRlKDI0MCAxMjAzIDEyMDMpIi8+Cgk8dXNlIHhsaW5rOmhyZWY9IiNhIiB0cmFuc2Zvcm09InJvdGF0ZSgzMDAgMTIwMyAxMjAzKSIvPgoKPC9zdmc+";

class AskAI {
  getInfo() {
    return {
      id: 'aichat_programordie',
      name: 'AI Chat',
      menuIconURI: menuIcon,
      blockIconURI: blockIcon,
      color1: '#00A67E',

      blocks: [
        {
          opcode: 'ask',
          blockType: Scratch.BlockType.REPORTER,
          text: 'Ask AI [PROMPT]',
          disableMonitor: true,
          arguments: {
            PROMPT: {
              type: Scratch.ArgumentType.STRING
            }
          }
        }
      ]
    };
  }

  normalText(r) {
    r = r.replace('\\', "");
    r = r.replace('\\', "");
    return r;
  }

  ask({ PROMPT }) {
    //MY API//
    let url = 'https://programordie-1-b6431438.deta.app/aichat/chat?prompt=';
    return Scratch.fetch(url+Scratch.Cast.toString(PROMPT))
    .then((r) => r.text())
    .then(r => this.normalText(r))
    .catch((err) => "Error! Please contact programORdie if this keeps happening.");
  }
}

Scratch.extensions.register(new AskAI());
})(Scratch);
